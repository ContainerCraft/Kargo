version: v1alpha1
debug: false
machine:
  kubelet:
    disableManifestsDirectory: true
    extraArgs:
      feature-gates: ServerSideApply=true
    extraMounts:
      - destination: /etc/cni/net.d
        type: bind
        source: /etc/cni/net.d
        options:
          - bind
          - rshared
          - rw
      - destination: /opt/cni/bin
        type: bind
        source: /opt/cni/bin
        options:
          - bind
          - rshared
          - rw
  time:
    disabled: true
  network:
    hostname: op2
    nameservers:
      - 192.168.1.1
    extraHostEntries:
      - ip: 192.168.1.42
        aliases:
          - op2
    interfaces:
      - interface: br0
        mtu: 1500
        addresses:
          - 192.168.1.42/24
        routes:
          - network: 0.0.0.0/0
            gateway: 192.168.1.1
            metric: 1024
        bridge:
          stp:
            enabled: true
          interfaces:
            - enp3s0
  install:
    wipe: true
    extraKernelArgs:
      - talos.platform=metal
      - reboot=k
